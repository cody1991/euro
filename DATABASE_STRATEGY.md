# 数据库策略说明

## 当前方案：自动初始化数据库

### 工作原理

1. **开发环境**：使用项目根目录的 `travel_planner.db` 文件
2. **生产环境**：使用 `/tmp/travel_planner.db` 文件
3. **自动初始化**：服务器启动时自动检查并初始化数据

### 优点

- ✅ 不需要在仓库中存储数据库文件
- ✅ 每次部署都有完整的数据
- ✅ 在线修改数据不会影响代码仓库
- ✅ 支持数据持久化（在 Render 等平台）

### 缺点

- ❌ 每次重新部署会丢失在线修改
- ❌ 无法通过 Git 追踪数据变化

## 数据管理方案

### 方案 1：当前方案（推荐）

- 数据库文件不存储在仓库中
- 服务器启动时自动初始化数据
- 适合大多数应用场景

### 方案 2：外部数据库服务

如果需要数据持久化，可以考虑：

- **PostgreSQL** (Render 提供免费 PostgreSQL)
- **MongoDB Atlas** (免费 MongoDB 云服务)
- **PlanetScale** (免费 MySQL 服务)

### 方案 3：数据备份

如果需要保留在线修改：

1. 定期导出数据库
2. 手动更新仓库中的数据文件
3. 重新部署

## 部署配置

### Render 环境变量

```
NODE_ENV=production
PORT=10000
DATABASE_URL=/tmp/travel_planner.db
```

### 本地开发

```bash
# 开发环境使用项目根目录的数据库
NODE_ENV=development
```

## 数据初始化

服务器启动时会自动：

1. 检查数据库是否存在
2. 如果不存在，自动创建表结构
3. 插入示例数据

## 修改数据

### 开发环境

直接修改 `travel_planner.db` 文件

### 生产环境

1. 通过 API 修改数据
2. 数据存储在 `/tmp/travel_planner.db`
3. 重新部署会重置数据

## 建议

对于你的应用，当前方案是最合适的：

- 数据相对稳定
- 不需要频繁修改
- 部署简单
- 免费且可靠
